    <script>
        // Add active state to current page
        document.addEventListener('DOMContentLoaded', function() {
            // Handle file:/// protocol and normal paths
            let currentPage = window.location.href;
            currentPage = decodeURIComponent(currentPage);
            currentPage = currentPage.split('\\').pop().split('/').pop() || 'index.html';
            
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                if (link.getAttribute('href') === currentPage) {
                    link.classList.add('active');
                    link.setAttribute('aria-current', 'page');
                }
            });
        });
    </script>
